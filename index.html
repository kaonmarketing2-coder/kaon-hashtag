<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Icebreaking Hashtag Wall</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Firebase v9 compat (ì‰¬ìš´ ë¬¸ë²•ìš©) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    :root {
      --bg-orange: #ffe9d1;
      --accent-orange: #ffb870;
      --accent-orange-deep: #ff914d;
      --text-dark: #333333;
      --pill-bg: #fff5ea;
      --pill-border: #ffb870;
      --pill-read-bg: #e0e0e0;
      --pill-read-text: #777777;
    }

    * {
      box-sizing: border-box;
    }

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont,
    "Segoe UI", "Noto Sans KR", sans-serif;
  background: linear-gradient(
      135deg,
      #FFE9D1 0%,
      #FFE1C4 40%,
      #FFD8B4 100%
  );
  color: var(--text-dark);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: stretch;
}


    .app-container {
      width: 100%;
      max-width: 1200px;
      min-height: 100vh;
      background: #ffffff;
      box-shadow: 0 0 25px rgba(0,0,0,0.08);
      position: relative;
      display: flex;
      flex-direction: column;
    }

    /* ìƒë‹¨ í—¤ë” */
    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 24px;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .app-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--accent-orange-deep);
    }

    .header-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .header-btn {
      border: none;
      background: transparent;
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.1);
      cursor: pointer;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.2s, transform 0.05s;
    }

    .header-btn:hover {
      background: rgba(0,0,0,0.04);
    }

    .header-btn:active {
      transform: scale(0.97);
    }

    .reset-icon {
      font-size: 1rem;
    }

    /* ë©”ì¸ ì˜ì—­ */
    .app-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 24px;
      overflow: hidden;
    }

    /* ê³µí†µ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .card {
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.06);
      padding: 24px 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    /* ì²« í™”ë©´: ì…ë ¥ í¼ */
    #intro-view {
      display: flex;
      flex-direction: column;
      justify-content: center;
      flex: 1;
    }

    /* ì²« í™”ë©´ ì¹´ë“œ ì „ì²´ ê°€ìš´ë° ì •ë ¬ */
    .intro-card {
      text-align: center;
    }

    /* ì…ë ¥ì¹¸ ì˜ì—­ë§Œ ë‹¤ì‹œ ì™¼ìª½ ì •ë ¬ + ì ë‹¹í•œ í­ */
    .intro-card .hashtag-inputs {
      text-align: left;
      margin-left: auto;
      margin-right: auto;
      max-width: 450px;
    }

    .intro-title {
      font-size: 1.4rem;
      font-weight: 700;
      line-height: 1.4;
      margin-bottom: 16px;
    }

    .intro-desc {
      font-size: 0.95rem;
      color: #777;
      margin-bottom: 24px;
    }

    .hashtag-inputs {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 24px;
    }

    .hashtag-input-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .hashtag-prefix {
      padding: 8px 10px;
      border-radius: 999px;
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      font-size: 0.9rem;
      color: var(--accent-orange-deep);
      flex-shrink: 0;
    }

    .hashtag-input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.1);
      padding: 10px 14px;
      font-size: 0.95rem;
      outline: none;
    }

    .hashtag-input:focus {
      border-color: var(--accent-orange);
      box-shadow: 0 0 0 2px rgba(255,184,112,0.25);
    }

    .submit-btn {
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 12px 16px;
      font-size: 1rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--accent-orange), var(--accent-orange-deep));
      color: #fff;
      cursor: pointer;
      transition: transform 0.06s, box-shadow 0.06s, filter 0.06s;
      box-shadow: 0 6px 18px rgba(255,145,77,0.35);
      margin-bottom: 4px;
    }

    .submit-btn:hover {
      filter: brightness(1.03);
      box-shadow: 0 8px 22px rgba(255,145,77,0.42);
    }

    .submit-btn:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 4px 12px rgba(255,145,77,0.32);
    }

    .helper-text {
      font-size: 0.85rem;
      color: #999;
    }

    /* ì—ëŸ¬ ë©”ì‹œì§€ */
    .error-msg {
      font-size: 0.85rem;
      color: #d9534f;
      margin-top: 8px;
      min-height: 18px;
    }

    /* ë‘ ë²ˆì§¸ í™”ë©´: í•´ì‹œíƒœê·¸ ëª¨ìŒ */
    #wall-view {
      display: none;
      flex-direction: column;
      flex: 1;
      gap: 16px;
    }

    .wall-header-text {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .tag-cloud {
      flex: 1;
      border-radius: 20px;
      padding: 16px;
      background: #fffaf4;
      overflow-y: auto;
      display: flex;
      flex-wrap: wrap;
      align-content: flex-start;
      gap: 10px 10px;
    }

.tag-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 14px 22px;        /* ê¸°ì¡´: 8px 14px â†’ ë‘ ë°° ì •ë„ í™•ëŒ€ */
  border-radius: 999px;
  background: var(--pill-bg);
  border: 2px solid var(--pill-border);   /* í…Œë‘ë¦¬ë„ ë” êµµê²Œ */
  font-size: 1.2rem;         /* ê¸°ì¡´: 0.95rem */
  font-weight: 600;          /* ê¸€ì”¨ ë” ë˜ë ·í•˜ê²Œ */
  cursor: pointer;
  user-select: none;
  transition: transform 0.06s, box-shadow 0.06s, background 0.1s;
  white-space: nowrap;
}

    .tag-pill:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.06);
      background: #fff;
    }

    .tag-pill:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .tag-pill.read {
      background: var(--pill-read-bg);
      color: var(--pill-read-text);
      border-color: var(--pill-read-bg);
    }

    /* ë‘ ë²ˆì§¸ í™”ë©´ ì¹´ë“œ ê°€ìš´ë° ì •ë ¬ */
    .wall-card {
      text-align: center;
    }

    /* ë‘ ë²ˆì§¸ í™”ë©´ - ì²« í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë²„íŠ¼ */
    .back-hashtag-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 14px;
      border-radius: 999px;
      border: none;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      background: var(--pill-bg);
      border: 1px solid var(--pill-border);
      color: var(--accent-orange-deep);
      margin-top: 4px;
      transition: background 0.15s, transform 0.05s;
    }

    .back-hashtag-btn:hover {
      background: #fff;
      transform: translateY(-1px);
    }

    .back-hashtag-btn:active {
      transform: translateY(0);
    }

    /* ì„ íƒëœ íƒœê·¸ í™•ëŒ€ í‘œì‹œìš© ëª¨ë‹¬ */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.25);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 50;
      padding: 16px;
    }

    .overlay-card {
      background: #fff;
      border-radius: 24px;
      max-width: 480px;
      width: 100%;
      padding: 24px 20px 20px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.26);
      text-align: center;
    }

    /* íŒì—… í•´ì‹œíƒœê·¸ í¬ê¸° í‚¤ìš°ê³  ë²„íŠ¼ê³¼ ê°„ê²© ì¤„ì´ê¸° */
    .overlay-tag {
      display: inline-block;
      padding: 18px 28px;
      border-radius: 999px;
      background: var(--pill-bg);
      border: 2px solid var(--pill-border);
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .overlay-btn {
      border: none;
      border-radius: 999px;
      padding: 12px 20px;
      font-size: 1rem;
      font-weight: 600;
      background: linear-gradient(135deg, var(--accent-orange), var(--accent-orange-deep));
      color: #fff;
      cursor: pointer;
      transition: transform 0.06s, box-shadow 0.06s, filter 0.06s;
      box-shadow: 0 6px 18px rgba(255,145,77,0.35);
      margin-top: 6px;
    }

    .overlay-btn:hover {
      filter: brightness(1.04);
    }

    .overlay-btn:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 4px 12px rgba(255,145,77,0.32);
    }

    .overlay-close {
      margin-top: 8px;
      font-size: 0.85rem;
      color: #999;
      cursor: pointer;
      text-decoration: underline;
    }

    /* ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .app-main {
        padding: 16px;
      }

      .card {
        padding: 20px 16px;
      }

      .intro-title {
        font-size: 1.2rem;
      }

      .overlay-card {
        padding: 20px 16px 16px;
      }

      .overlay-tag {
        font-size: 1.5rem;
        padding: 16px 24px;
      }
    }
  </style>
</head>
<body>
<div class="app-container">
  <header class="app-header">
    <div class="app-title">KAON Hashtags</div>
    <div class="header-right">
      <!-- ì²« í™”ë©´ì—ì„œ ë³´ì´ëŠ” ë²„íŠ¼ -->
      <button class="header-btn" id="viewAllBtn">
        <span>ì „ì²´ë³´ê¸°</span>
      </button>
      <!-- ë‘ ë²ˆì§¸ í™”ë©´ì—ì„œ ë³´ì´ëŠ” ë²„íŠ¼ -->
      <button class="header-btn" id="resetBtn">
        <span class="reset-icon">ğŸ”</span>
        <span>ë¦¬ì…‹</span>
      </button>
    </div>
  </header>

  <main class="app-main">
    <!-- 1) í•´ì‹œíƒœê·¸ ì…ë ¥ í™”ë©´ -->
    <section id="intro-view">
      <div class="card intro-card">
        <div class="intro-title">
          ë‚˜ë¥¼ ì˜ í‘œí˜„í•  ìˆ˜ ìˆëŠ” í‚¤ì›Œë“œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”!<br />
          <span style="font-size:0.9rem; font-weight:400;">
            (ex. ê´€ì‹¬ì‚¬, ì·¨ë¯¸, ê²½ë ¥ ë“±)
          </span>
        </div>
        <p class="intro-desc">
          tip: ì¬ë°ŒëŠ” ìŠ¤í† ë¦¬ê°€ ìˆê±°ë‚˜, ë‚¨ë“¤ì´ ì‹ ê¸°í•´ í• ë§Œí•œ ì´ì•¼ê¸°ê°€ ìˆìœ¼ë©´ ë” ì¢‹ì•„ìš”ğŸ‘
        </p>

        <div class="hashtag-inputs">
          <div class="hashtag-input-row">
            <span class="hashtag-prefix">#</span>
            <input
              type="text"
              class="hashtag-input"
              id="tag1"
              maxlength="60"
              autocomplete="off"
              placeholder="ì˜ˆ: ì»¤í”¼, ë§›ì§‘íƒë°©, ìœ¡ì•„"
            >
          </div>
        </div>

        <button class="submit-btn" id="submitBtn">ì œì¶œ</button>
        <div class="helper-text">
          ì œì¶œ í›„ì—ëŠ” ì‚­ì œê°€ ì–´ë µìŠµë‹ˆë‹¤!
        </div>
        <div class="error-msg" id="introError"></div>
      </div>
    </section>

    <!-- 2) ì „ì²´ í•´ì‹œíƒœê·¸ ëª¨ìŒ í™”ë©´ -->
    <section id="wall-view">
      <div class="card wall-card" style="margin-bottom:12px;">
        <div class="wall-header-text">
          ëª¨ë‘ê°€ ì‘ì„±í•œ í•´ì‹œíƒœê·¸ ëª¨ìŒ
        </div>
        <div style="font-size:0.85rem; color:#888; margin-bottom: 6px;">
          ëˆ„ê°€ ì´ í‚¤ì›Œë“œë¥¼ ì‘ì„±í–ˆì„ì§€ ìƒìƒí•´ ë³´ì„¸ìš”ğŸ‘€
        </div>
        <!-- ì²« í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ë²„íŠ¼ -->
        <button class="back-hashtag-btn" id="backToIntroBtn">#í•´ì‹œíƒœê·¸ ì¶”ê°€í•˜ëŸ¬ ê°€ê¸°</button>
      </div>
      <div class="tag-cloud" id="tagCloud">
        <!-- íƒœê·¸ë“¤ì´ ì—¬ê¸°ì— JSë¡œ ë Œë”ë§ë¨ -->
      </div>
    </section>
  </main>
</div>

<!-- ì„ íƒëœ íƒœê·¸ í™•ëŒ€ ëª¨ë‹¬ -->
<div class="overlay" id="overlay">
  <div class="overlay-card">

    <div style="font-size:0.9rem; color:#999; margin-bottom:6px;">
      ì„ íƒí•œ í•´ì‹œíƒœê·¸
    </div>

    <!-- í•´ì‹œíƒœê·¸: ë¸”ë¡ ìš”ì†Œ + ì•„ë˜ ê°„ê²© ì¡°ì ˆ -->
    <div class="overlay-tag" id="overlayTag"
         style="display:block; margin:0 auto 12px auto;">
    </div>

    <!-- ì†Œê°œ ì™„ë£Œ ë²„íŠ¼: ë¸”ë¡ ìš”ì†Œ + ì¤‘ì•™ ì •ë ¬ + ìì—°ìŠ¤ëŸ¬ìš´ ìœ„ ê°„ê²© -->
    <button class="overlay-btn" id="markReadBtn"
            style="display:block; margin:8px auto 0 auto;">
      ì†Œê°œ ì™„ë£Œ!
    </button>

    <div class="overlay-close" id="overlayClose"
         style="margin-top:10px;">
      ë‹«ê¸°
    </div>

  </div>
</div>


<script>
  document.addEventListener('DOMContentLoaded', () => {
    // 1) Firebase ì´ˆê¸°í™” -------------------------------------------------
    const firebaseConfig = {
      apiKey: "AIzaSyCExGHCQEynsuzvv4Rf2Sb1670pQKk7KRg",
      authDomain: "icebreaker-hashtag.firebaseapp.com",
      projectId: "icebreaker-hashtag",
      storageBucket: "icebreaker-hashtag.firebasestorage.app",
      messagingSenderId: "310987384904",
      appId: "1:310987384904:web:37d27e4c4242b35ff0d07d"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // 2) DOM ìš”ì†Œ ì°¸ì¡° ----------------------------------------------------
    const introView = document.getElementById('intro-view');
    const wallView = document.getElementById('wall-view');
    const submitBtn = document.getElementById('submitBtn');
    const introError = document.getElementById('introError');
    const tagInputs = [
      document.getElementById('tag1'),
    ];
    const tagCloud = document.getElementById('tagCloud');
    const resetBtn = document.getElementById('resetBtn');
    const viewAllBtn = document.getElementById('viewAllBtn');
    const backToIntroBtn = document.getElementById('backToIntroBtn');

    const overlay = document.getElementById('overlay');
    const overlayTag = document.getElementById('overlayTag');
    const overlayClose = document.getElementById('overlayClose');
    const markReadBtn = document.getElementById('markReadBtn');

    let currentSelectedTagId = null;

    // ğŸ”¹ ì…ë ¥ì¹¸ / ì—ëŸ¬ë©”ì‹œì§€ ì´ˆê¸°í™” í•¨ìˆ˜ (í•­ìƒ "ê¹¨ë—í•œ ì²« í™”ë©´"ì„ ìœ„í•´)
    function resetIntroForm() {
      tagInputs.forEach(input => {
        input.value = '';
      });
      introError.textContent = '';
    }

    // 3) í™”ë©´ ì „í™˜ í•¨ìˆ˜ ---------------------------------------------------
    function showIntroView() {
      resetIntroForm(); // í•­ìƒ ê¹¨ë—í•œ ìƒíƒœë¡œ
      introView.style.display = 'flex';
      wallView.style.display = 'none';
      // ì²« í™”ë©´: ì „ì²´ë³´ê¸° ë²„íŠ¼ O, ë¦¬ì…‹ ë²„íŠ¼ X
      viewAllBtn.style.display = 'inline-flex';
      resetBtn.style.display = 'none';
    }

    function showWallView() {
      introView.style.display = 'none';
      wallView.style.display = 'flex';
      // ë‘ ë²ˆì§¸ í™”ë©´: ì „ì²´ë³´ê¸° ë²„íŠ¼ X, ë¦¬ì…‹ ë²„íŠ¼ O
      viewAllBtn.style.display = 'none';
      resetBtn.style.display = 'inline-flex';
    }

    // 4) í•´ì‹œíƒœê·¸ ì œì¶œ ë¡œì§ ----------------------------------------------
    submitBtn.addEventListener('click', async () => {
      introError.textContent = '';

      const values = tagInputs
        .map(input => input.value.trim())
        .filter(v => v.length > 0);

      if (values.length === 0) {
        introError.textContent = 'ìµœì†Œ í•œ ê°œ ì´ìƒì˜ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.';
        return;
      }

      // í™”ë©´ ë¨¼ì € ì „í™˜
      showWallView();

      try {
        const batch = db.batch();
        const colRef = db.collection('hashtags');
        const now = new Date();

        values.forEach(textRaw => {
          const text = textRaw.replace(/^#/, '').trim(); // ë§¨ ì• # ì œê±°
          if (!text) return;
          const docRef = colRef.doc();
          batch.set(docRef, {
            text: text,
            createdAt: now,
            read: false       // ì²˜ìŒ ìƒì„± ì‹œì—ëŠ” ì½ì§€ ì•Šì€ ìƒíƒœ
          });
        });

        await batch.commit();

        // ì‘ì„±í•œ ì‚¬ëŒ ìª½ ì…ë ¥ì¹¸ì€ ë¹„ì›Œë‘ 
        resetIntroForm();
      } catch (err) {
        console.error('[Firestore] í•´ì‹œíƒœê·¸ ì €ì¥ ì˜¤ë¥˜:', err);
        alert('í•´ì‹œíƒœê·¸ë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + (err.message || 'ìì„¸í•œ ë‚´ìš©ì€ ì½˜ì†”ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.'));
      }
    });

    // ì²« í™”ë©´ ìš°ì¸¡ ìƒë‹¨ 'ì „ì²´ë³´ê¸°' ë²„íŠ¼
    viewAllBtn.addEventListener('click', () => {
      showWallView();
    });

    // ë‘ ë²ˆì§¸ í™”ë©´ '#í•´ì‹œíƒœê·¸ ì¶”ê°€í•˜ëŸ¬ ê°€ê¸°' ë²„íŠ¼
    backToIntroBtn.addEventListener('click', () => {
      showIntroView(); // í•­ìƒ "ì˜ˆì‹œë§Œ ë³´ì´ëŠ” ê¹¨ë—í•œ ì²« í™”ë©´"
    });

    // ì…ë ¥ì°½ì—ì„œ Enter ëˆŒë €ì„ ë•Œë„ ì œì¶œ
    tagInputs.forEach((input, idx) => {
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          e.preventDefault();
          submitBtn.click();
        }
      });
    });

    // 5) í•´ì‹œíƒœê·¸ ë Œë”ë§ í•¨ìˆ˜ --------------------------------------------
    function renderTagCloud(tags) {
      tagCloud.innerHTML = '';

      if (!Array.isArray(tags) || tags.length === 0) {
        const emptyMsg = document.createElement('div');
        emptyMsg.textContent =
          'ì•„ì§ ì‘ì„±ëœ í•´ì‹œíƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ í‚¤ì›Œë“œë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”!';
        emptyMsg.style.fontSize = '0.95rem';
        emptyMsg.style.color = '#999';
        tagCloud.appendChild(emptyMsg);
        return;
      }

      tags.forEach(tag => {
        const pill = document.createElement('div');
        pill.className = 'tag-pill';

        // Firestore ê¸°ë°˜ ì½ìŒ ìƒíƒœ(íšŒìƒ‰) í‘œì‹œ
        if (tag.read === true) {
          pill.classList.add('read');
        }

        pill.dataset.id = tag.id;
        const displayText = tag.text || '';
        pill.textContent = '#' + displayText;

        pill.addEventListener('click', () => {
          currentSelectedTagId = tag.id;
          overlayTag.textContent = '#' + displayText;
          overlay.style.display = 'flex';
        });

        tagCloud.appendChild(pill);
      });
    }

    // Firestore ì‹¤ì‹œê°„ ë°˜ì˜ -----------------------------------------
    db.collection('hashtags')
      .orderBy('text')
      .onSnapshot(
        snapshot => {
          const tags = [];
          snapshot.forEach(doc => {
            tags.push({ id: doc.id, ...doc.data() });
          });

          // í…ìŠ¤íŠ¸ ê¸°ì¤€ ì •ë ¬ (ë¹„ìŠ·í•œ í•´ì‹œíƒœê·¸ë¼ë¦¬ ê°€ê¹Œì´)
          tags.sort((a, b) => {
            const ta = (a.text || '').toString();
            const tb = (b.text || '').toString();
            return ta.localeCompare(tb, 'ko');
          });

          renderTagCloud(tags);
        },
        error => {
          console.error('Firestore onSnapshot error:', error);
          renderTagCloud([]);
        }
      );

    // 6) ëª¨ë‹¬(í™•ëŒ€) ê´€ë ¨ ì´ë²¤íŠ¸ -------------------------------------------
    overlayClose.addEventListener('click', () => {
      overlay.style.display = 'none';
      currentSelectedTagId = null;
    });

    overlay.addEventListener('click', e => {
      if (e.target === overlay) {
        overlay.style.display = 'none';
        currentSelectedTagId = null;
      }
    });

    // ì†Œê°œì™„ë£Œ ë²„íŠ¼ â†’ Firestoreì— read: true ì—…ë°ì´íŠ¸
    markReadBtn.addEventListener('click', async () => {
      if (currentSelectedTagId) {
        try {
          await db.collection('hashtags').doc(currentSelectedTagId).update({
            read: true
          });
        } catch (err) {
          console.error('read ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', err);
          alert('ì†Œê°œì™„ë£Œ ìƒíƒœë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      }
      overlay.style.display = 'none';
      currentSelectedTagId = null;
    });

    // 7) ë¦¬ì…‹ ë²„íŠ¼ ê¸°ëŠ¥ ---------------------------------------------------
    resetBtn.addEventListener('click', async () => {
      const pw = prompt('ë¦¬ì…‹ ì•”í˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
      if (pw === null) return; // ì·¨ì†Œ

      if (pw !== '1234') {
        alert('ì•”í˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        return;
      }

      const ok = confirm(
        'ì •ë§ ëª¨ë“  í•´ì‹œíƒœê·¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
      );
      if (!ok) return;

      try {
        const snapshot = await db.collection('hashtags').get();
        const batch = db.batch();
        snapshot.forEach(doc => batch.delete(doc.ref));
        await batch.commit();

        alert('ëª¨ë“  í•´ì‹œíƒœê·¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      } catch (err) {
        console.error(err);
        alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
      }
    });

    // í˜ì´ì§€ ì²˜ìŒ ë¡œë“œ ì‹œëŠ” í•­ìƒ "ê¹¨ë—í•œ" ì…ë ¥ í™”ë©´ë¶€í„°
    showIntroView();
  });
</script>
</body>
</html>
